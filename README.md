# üìÖ Loopr

Un calendario moderno y extensible construido con **Preact**, que ofrece una arquitectura de hooks avanzada, gesti√≥n de estado reactiva y una API categorizada para el control total del calendario.

## üåü Caracter√≠sticas Principales

- **ü™∂ Ultra Ligero**: Construido con Preact (~3KB) para un bundle m√≠nimo
- **üèóÔ∏è Arquitectura Avanzada**: Sistema de hooks categorizados y contexto unificado
- **üîß API Categorizada**: Acciones organizadas por funcionalidad (`config`, `navigation`, `view`, `events`, `ui`)
- **‚ö° Alto Rendimiento**: Memoizaci√≥n extensiva y gesti√≥n optimizada del estado
- **üåç Internacionalizaci√≥n**: Soporte completo para m√∫ltiples idiomas y regiones
- **üì± Responsive**: Dise√±o adaptable con CSS modular
- **üéØ Control Granular**: Gesti√≥n avanzada de tareas as√≠ncronas y estados
- **üîÑ Sistema de Eventos**: Suscripci√≥n a cambios con controladores especializados
- **üîî Notificaciones Visuales**: Sistema completo de toasts con animaciones y configuraci√≥n avanzada
- **üé® Temas Din√°micos**: Soporte para modo claro/oscuro con transiciones suaves

## ÔøΩ Inicio R√°pido

```bash
# Instalar dependencias
npm install

# Modo desarrollo con hot reload
npm run dev

# Compilar para producci√≥n
npm run build
```

## üíª Uso B√°sico

### Configuraci√≥n del Contexto

```jsx
import { h, render } from 'preact';
import { CalendarProvider } from '@/context/CalendarContext.jsx';
import { ToastProvider } from '@/contexts/ToastContext.jsx';
import { CalendarApp } from '@/CalendarApp.jsx';

const App = () => (
  <ToastProvider>
    <CalendarProvider
      initialConfig={{ theme: 'dark', locale: 'es-MX' }}
      initialEvents={[]}
    >
      <CalendarApp />
    </CalendarProvider>
  </ToastProvider>
);

render(<App />, document.getElementById('app'));
```

### Usando el Contexto del Calendario

```jsx
import { useCalendarContext } from '@/context/CalendarContext.jsx';
import { useToast } from '@/contexts/ToastContext.jsx';

const MyComponent = () => {
  const {
    // Estado del calendario
    currentDate,
    config,
    events,
    activeView,

    // Acciones categorizadas
    configActions,
    navigation,
    view,
    events: eventActions,
    ui,

    // API plana (compatibilidad)
    setTheme,
    nextMonth,
    addEvent,
    showMonthView,
  } = useCalendarContext();

  // Sistema de notificaciones visuales
  const { addToast } = useToast();

  const handleAction = () => {
    // Ejecutar acci√≥n
    navigation.nextMonth();

    // Mostrar notificaci√≥n
    addToast({
      type: 'success',
      message: 'Navegado al siguiente mes',
      duration: 3000,
    });
  };

  return (
    <div>
      <button onClick={handleAction}>Siguiente Mes</button>
      <button onClick={() => view.showWeekView()}>Vista Semanal</button>
      <button onClick={() => configActions.toggleTheme()}>Cambiar Tema</button>
    </div>
  );
};
```

## üèóÔ∏è Arquitectura del Sistema

### üìÅ Estructura del Proyecto

```
src/
‚îú‚îÄ‚îÄ App.jsx                     # Componente ra√≠z
‚îú‚îÄ‚îÄ CalendarApp.jsx             # Aplicaci√≥n principal del calendario
‚îú‚îÄ‚îÄ CalendarContent.jsx         # Contenido principal
‚îú‚îÄ‚îÄ context/
‚îÇ   ‚îî‚îÄ‚îÄ CalendarContext.jsx     # Contexto global con estado y acciones
‚îú‚îÄ‚îÄ contexts/
‚îÇ   ‚îî‚îÄ‚îÄ ToastContext.jsx        # Sistema de notificaciones visuales
‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îú‚îÄ‚îÄ useCalendarActions.js   # Acciones del calendario
‚îÇ   ‚îú‚îÄ‚îÄ useCalendarTaskManager.js # Gesti√≥n de tareas as√≠ncronas
‚îÇ   ‚îú‚îÄ‚îÄ useCalendarController.js # Control de navegaci√≥n de fechas
‚îÇ   ‚îú‚îÄ‚îÄ useCalendarReducer.js   # Reducer del estado global
‚îÇ   ‚îî‚îÄ‚îÄ index.js               # Exportaciones centralizadas
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ common/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CalendarHeader.jsx  # Header principal
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ CalendarViews.jsx   # Selector de vistas
‚îÇ   ‚îú‚îÄ‚îÄ viewHeader/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Toolbar.jsx         # Barra de herramientas
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ToolbarSection.jsx  # Secciones de la toolbar
‚îÇ   ‚îú‚îÄ‚îÄ viewMonth/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ MonthDays.jsx       # Grilla de d√≠as del mes
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ MonthDaysHeader.jsx # Header de d√≠as de semana
‚îÇ   ‚îú‚îÄ‚îÄ views/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ MonthView.jsx       # Vista mensual completa
‚îÇ   ‚îú‚îÄ‚îÄ ToastSystem.jsx         # Sistema de notificaciones toast
‚îÇ   ‚îú‚îÄ‚îÄ VisualNotificationSettings.jsx # Configuraci√≥n de notificaciones
‚îÇ   ‚îî‚îÄ‚îÄ ThemeSwitcher.jsx       # Cambio de temas
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îú‚îÄ‚îÄ initialConfig.js        # Configuraci√≥n inicial
‚îÇ   ‚îî‚îÄ‚îÄ ToolbarConfig.js        # Configuraci√≥n de toolbar
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îî‚îÄ‚îÄ dateUtils.js           # Utilidades de fechas
‚îî‚îÄ‚îÄ css/                       # Estilos modulares organizados
```

### üéØ Sistema de Hooks

#### `useCalendarContext()`

**Hook principal** que proporciona acceso completo al estado y acciones del calendario:

```jsx
const {
  // üìä Estado
  currentDate, // Fecha actual
  config, // Configuraci√≥n del calendario
  events, // Lista de eventos
  activeView, // Vista activa ('month', 'week', 'day')
  selectedEvents, // Eventos seleccionados

  // üéõÔ∏è Controladores
  dateController, // Control de navegaci√≥n de fechas

  // ÔøΩÔ∏è Acciones Categorizadas
  configActions: {
    updateConfig, // Actualizar configuraci√≥n
    setTheme, // Cambiar tema
    toggleTheme, // Alternar tema
    setLocale, // Cambiar idioma
    setTimeFormat, // Formato de hora
  },
  navigation: {
    goToToday, // Ir a hoy
    nextMonth, // Siguiente mes
    prevMonth, // Mes anterior
    nextYear, // Siguiente a√±o
    prevYear, // A√±o anterior
  },
  view: {
    showMonthView, // Mostrar vista mensual
    showWeekView, // Mostrar vista semanal
    showDayView, // Mostrar vista diaria
    setActiveView, // Cambiar vista
  },
  events: {
    addEvent, // Agregar evento
    updateEvent, // Actualizar evento
    deleteEvent, // Eliminar evento
    setEvents, // Establecer eventos
    selectEvent, // Seleccionar evento
  },
  ui: {
    openEventModal, // Abrir modal de evento
    closeEventModal, // Cerrar modal
    setError, // Establecer error
    setLoading, // Establecer carga
    toggleSidebar, // Alternar sidebar
  },
} = useCalendarContext();
```

#### `useCalendarTaskManager()`

**Hook avanzado** para gesti√≥n de tareas as√≠ncronas con control de estado:

```jsx
const taskManager = useCalendarTaskManager();

// Ejecutar tarea con manejo de estado autom√°tico
await taskManager.executeTask('loadEvents', async () => {
  const events = await fetchEventsFromAPI();
  return events;
});

// Gesti√≥n de m√∫ltiples tareas
await taskManager.executeTasks([
  ['loadEvents', loadEventsTask],
  ['syncCalendar', syncTask],
  ['updateUI', updateTask],
]);
```

## ÔøΩ API Categorizada

### üîß Acciones de Configuraci√≥n (`configActions`)

```jsx
const { configActions } = useCalendarContext();

// Gesti√≥n de temas
configActions.setTheme('dark');
configActions.toggleTheme();

// Internacionalizaci√≥n
configActions.setLocale('es-MX');
configActions.setTimeFormat('24h');
configActions.setFirstDayOfWeek(1); // Lunes

// Configuraci√≥n personalizada
configActions.updateConfig({
  theme: 'dark',
  locale: 'en-US',
  weekendsVisible: true,
});
```

### üß≠ Acciones de Navegaci√≥n (`navigation`)

```jsx
const { navigation } = useCalendarContext();

// Navegaci√≥n b√°sica
navigation.goToToday();
navigation.nextMonth();
navigation.prevMonth();
navigation.nextYear();
navigation.prevYear();

// Navegaci√≥n avanzada
navigation.nextWeek();
navigation.prevWeek();
navigation.setDate(new Date('2024-12-25'));
navigation.incrementDate(7, 'day');
```

### üëÅÔ∏è Acciones de Vista (`view`)

```jsx
const { view } = useCalendarContext();

// Cambio de vistas
view.showMonthView();
view.showWeekView();
view.showDayView();
view.showAgendaView();

// Control directo
view.setActiveView('week');
```

### ÔøΩ Acciones de Eventos (`events`)

```jsx
const { events } = useCalendarContext();

// Gesti√≥n de eventos (con Promises)
try {
  const newEvent = await events.addEvent({
    title: 'Reuni√≥n importante',
    date: new Date(),
    description: 'Descripci√≥n del evento',
  });

  await events.updateEvent(newEvent.id, {
    title: 'Reuni√≥n actualizada',
  });

  await events.deleteEvent(newEvent.id);
} catch (error) {
  console.error('Error:', error);
}

// Selecci√≥n de eventos
events.selectEvent(event);
events.clearSelectedEvents();
```

### üéõÔ∏è Acciones de UI (`ui`)

```jsx
const { ui } = useCalendarContext();

// Modales
ui.openEventModal(selectedDate);
ui.closeEventModal();

// Estados de aplicaci√≥n
ui.setLoading(true);
ui.setError('Error al cargar eventos');
ui.clearError();

// Interfaz
ui.toggleSidebar();
ui.setSidebarOpen(false);
```

## üîî Sistema de Notificaciones Visuales

Loopr incluye un sistema completo de notificaciones visuales tipo toast que reemplaza las notificaciones del navegador, ofreciendo mejor control y experiencia de usuario.

### üé® Tipos de Notificaciones

```jsx
import { useToast } from '@/contexts/ToastContext.jsx';

const MyComponent = () => {
  const { addToast } = useToast();

  const showNotifications = () => {
    // Notificaci√≥n de √©xito
    addToast({
      type: 'success',
      message: '¬°Evento creado exitosamente!',
      duration: 3000,
    });

    // Notificaci√≥n de error
    addToast({
      type: 'error',
      message: 'Error al guardar el evento',
      duration: 5000,
    });

    // Notificaci√≥n de advertencia
    addToast({
      type: 'warning',
      message: 'El evento se solapa con otro existente',
      duration: 4000,
    });

    // Notificaci√≥n informativa
    addToast({
      type: 'info',
      message: 'Sincronizando calendario...',
      duration: 2000,
    });

    // Recordatorio
    addToast({
      type: 'reminder',
      message: 'Reuni√≥n en 15 minutos',
      duration: 0, // No se cierra autom√°ticamente
      actions: [
        { text: 'Posponer', action: 'snooze' },
        { text: 'Ver', action: 'view' },
      ],
    });
  };

  return <button onClick={showNotifications}>Mostrar Notificaciones</button>;
};
```

### ‚öôÔ∏è Configuraci√≥n de Notificaciones

```jsx
import {
  useToast,
  VisualNotificationManager,
} from '@/contexts/ToastContext.jsx';

const NotificationComponent = () => {
  const { config, updateConfig } = useToast();

  const handleConfigChange = newConfig => {
    updateConfig(newConfig);
  };

  return (
    <div>
      {/* Configuraci√≥n de posici√≥n */}
      <select
        value={config.position}
        onChange={e => handleConfigChange({ position: e.target.value })}
      >
        <option value='top-right'>Superior Derecha</option>
        <option value='top-left'>Superior Izquierda</option>
        <option value='top-center'>Superior Centro</option>
        <option value='bottom-right'>Inferior Derecha</option>
        <option value='bottom-left'>Inferior Izquierda</option>
        <option value='bottom-center'>Inferior Centro</option>
      </select>

      {/* Configuraci√≥n de comportamiento */}
      <label>
        <input
          type='checkbox'
          checked={config.autoDismiss}
          onChange={e => handleConfigChange({ autoDismiss: e.target.checked })}
        />
        Auto-cerrar notificaciones
      </label>

      <label>
        <input
          type='checkbox'
          checked={config.pauseOnHover}
          onChange={e => handleConfigChange({ pauseOnHover: e.target.checked })}
        />
        Pausar al pasar el mouse
      </label>

      <label>
        <input
          type='checkbox'
          checked={config.soundEnabled}
          onChange={e => handleConfigChange({ soundEnabled: e.target.checked })}
        />
        Sonidos de notificaci√≥n
      </label>
    </div>
  );
};
```

### üéµ Sonidos y Efectos

El sistema incluye sonidos personalizados para cada tipo de notificaci√≥n:

```jsx
// Configuraci√≥n de sonidos por tipo
const soundConfig = {
  success: { frequency: 800, duration: 200 },
  error: { frequency: 400, duration: 400 },
  warning: { frequency: 600, duration: 300 },
  info: { frequency: 500, duration: 150 },
  reminder: { frequency: 700, duration: 250 },
};

// Los sonidos se pueden deshabilitar globalmente
updateConfig({ soundEnabled: false });
```

### üì± Notificaciones Programadas

```jsx
import { VisualNotificationManager } from '@/contexts/ToastContext.jsx';

// Programar notificaci√≥n
VisualNotificationManager.scheduleNotification({
  type: 'reminder',
  message: 'Reuni√≥n de equipo',
  scheduledTime: new Date(Date.now() + 15 * 60 * 1000), // 15 minutos
  actions: [
    { text: 'Unirse', action: 'join' },
    { text: 'Posponer 5m', action: 'snooze' },
  ],
});

// Cancelar notificaci√≥n programada
VisualNotificationManager.cancelScheduledNotification(notificationId);
```

## üåç Internacionalizaci√≥n

Soporte completo para m√∫ltiples idiomas y configuraciones regionales:

```jsx
const { configActions } = useCalendarContext();

// Configurar idioma
configActions.setLocale('es-MX'); // Espa√±ol M√©xico
configActions.setLocale('en-US'); // Ingl√©s Estados Unidos
configActions.setLocale('fr-FR'); // Franc√©s Francia

// Configurar formatos
configActions.setDateFormat('DD/MM/YYYY');
configActions.setTimeFormat('24h');
configActions.setFirstDayOfWeek(1); // 0=Domingo, 1=Lunes
```

## ‚öôÔ∏è Configuraci√≥n Avanzada

### Configuraci√≥n Inicial

```jsx
const initialConfig = {
  locale: 'es-MX',
  firstDayOfWeek: 1,
  timeFormat: '24h',
  dateFormat: 'DD/MM/YYYY',
  theme: 'dark',
  weekendsVisible: true,
  viewToolbar: {
    start: [{ action: 'today' }, { action: 'month' }, { action: 'week' }],
    center: [{ action: 'title' }],
    end: [{ action: 'prev' }, { action: 'next' }],
  },
};

<CalendarProvider initialConfig={initialConfig}>
  <App />
</CalendarProvider>;
```

### Eventos Iniciales

```jsx
const initialEvents = [
  {
    id: '1',
    title: 'Evento importante',
    date: new Date('2024-01-15'),
    description: 'Descripci√≥n del evento',
  },
];

<CalendarProvider initialEvents={initialEvents}>
  <App />
</CalendarProvider>;
```

## üéØ Ejemplos de Uso

### Componente de Control Personalizado

```jsx
import { useCalendarContext } from '@/context/CalendarContext.jsx';

const CustomControls = () => {
  const { navigation, view, configActions, currentDate } = useCalendarContext();

  return (
    <div className='custom-controls'>
      {/* Navegaci√≥n */}
      <div className='nav-controls'>
        <button onClick={navigation.prevMonth}>‚Üê</button>
        <span>{currentDate.toLocaleDateString()}</span>
        <button onClick={navigation.nextMonth}>‚Üí</button>
      </div>

      {/* Selector de vista */}
      <div className='view-controls'>
        <button onClick={view.showMonthView}>Mes</button>
        <button onClick={view.showWeekView}>Semana</button>
        <button onClick={view.showDayView}>D√≠a</button>
      </div>

      {/* Configuraci√≥n */}
      <div className='config-controls'>
        <button onClick={configActions.toggleTheme}>Cambiar Tema</button>
      </div>
    </div>
  );
};
```

### Gesti√≥n de Eventos Avanzada

```jsx
import { useCalendarContext, useCalendarTaskManager } from '@/hooks';
import { useToast } from '@/contexts/ToastContext.jsx';

const EventManager = () => {
  const { events, ui } = useCalendarContext();
  const taskManager = useCalendarTaskManager();
  const { addToast } = useToast();

  const handleAddEvent = async eventData => {
    try {
      ui.setLoading(true);

      const newEvent = await taskManager.executeTask('addEvent', async () => {
        // Validar datos
        if (!eventData.title) throw new Error('T√≠tulo requerido');

        // Agregar evento
        return await events.addEvent({
          ...eventData,
          id: `event_${Date.now()}`,
        });
      });

      // Notificaci√≥n de √©xito
      addToast({
        type: 'success',
        message: `Evento "${newEvent.title}" creado exitosamente`,
        duration: 3000,
      });

      console.log('Evento agregado:', newEvent);
    } catch (error) {
      // Notificaci√≥n de error
      addToast({
        type: 'error',
        message: `Error al agregar evento: ${error.message}`,
        duration: 5000,
      });

      ui.setError(`Error al agregar evento: ${error.message}`);
    } finally {
      ui.setLoading(false);
    }
  };

  return (
    <div className='event-manager'>
      <button
        onClick={() =>
          handleAddEvent({
            title: 'Nuevo evento',
            date: new Date(),
          })
        }
      >
        Agregar Evento
      </button>
    </div>
  );
};
```

### Sistema de Notificaciones Completo

```jsx
import {
  ToastProvider,
  useToast,
  VisualNotificationSettings,
} from '@/contexts/ToastContext.jsx';
import { ToastSystem } from '@/components/ToastSystem.jsx';

const NotificationApp = () => {
  const { toasts, removeToast, config } = useToast();

  return (
    <div className='app'>
      {/* Contenido principal */}
      <main>
        <EventManager />
        <VisualNotificationSettings />
      </main>

      {/* Sistema de toasts */}
      <ToastSystem toasts={toasts} onClose={removeToast} config={config} />
    </div>
  );
};

// Configuraci√≥n completa de la aplicaci√≥n
const App = () => (
  <ToastProvider
    initialConfig={{
      position: 'top-right',
      autoDismiss: true,
      duration: 4000,
      pauseOnHover: true,
      soundEnabled: true,
      showProgress: true,
    }}
  >
    <CalendarProvider>
      <NotificationApp />
    </CalendarProvider>
  </ToastProvider>
);
```

## üõ†Ô∏è Scripts de Desarrollo

```bash
# Desarrollo
npm run dev          # Servidor con hot reload
npm run build        # Build de producci√≥n
npm run clean        # Limpiar dist/

# Calidad de c√≥digo
npm run lint         # ESLint
npm run lint:fix     # Corregir autom√°ticamente
npm run format:check # Verificar formato
npm run format:write # Formatear c√≥digo
```

## üìä Caracter√≠sticas T√©cnicas

- **üì¶ Bundle Size**: ~22KB minificado + gzip (incluye sistema de notificaciones)
- **üéØ Compatibilidad**: Navegadores modernos (ES6+)
- **‚ö° Rendimiento**: Memoizaci√≥n extensiva, lazy loading
- **‚ôø Accesibilidad**: ARIA labels, navegaci√≥n por teclado, notificaciones accesibles
- **üîß Extensibilidad**: Arquitectura modular y hooks personalizados
- **üß™ Testing**: Estructura preparada para tests unitarios
- **üîî Notificaciones**: Sistema completo sin dependencias externas
- **üé® Animaciones**: Transiciones CSS optimizadas y fluidas

## ü§ù Estado del Proyecto

### ‚úÖ Implementado

- ‚úÖ Arquitectura de hooks avanzada
- ‚úÖ Contexto unificado con API categorizada
- ‚úÖ Sistema de acciones organizadas
- ‚úÖ Gesti√≥n de tareas as√≠ncronas
- ‚úÖ Componentes principales migrados
- ‚úÖ Control de navegaci√≥n avanzado
- ‚úÖ Internacionalizaci√≥n completa
- ‚úÖ Sistema de temas din√°mico
- ‚úÖ Toolbar configurable
- ‚úÖ **Sistema de notificaciones visuales completo**
- ‚úÖ **Toasts con animaciones y m√∫ltiples tipos**
- ‚úÖ **Configuraci√≥n avanzada de notificaciones**
- ‚úÖ **Sonidos personalizados por tipo**
- ‚úÖ **Notificaciones programadas**
- ‚úÖ **Reemplazo completo de notificaciones del navegador**

### üöß En Desarrollo

- üöß Vista semanal completa
- üöß Vista diaria detallada
- üöß Sistema de eventos avanzado
- üöß Drag & Drop de eventos
- üöß Exportaci√≥n de calendario

### üìã Roadmap

- üìã Tests unitarios completos
- üìã Storybook para componentes
- üìã Plugin system
- üìã TypeScript support
- üìã PWA capabilities

## üë®‚Äçüíª Autor

**Bert0h-dev** - [GitHub](https://github.com/bert0h-dev)

## üìÑ Licencia

ISC License - Ver [LICENSE](LICENSE) para m√°s detalles.

---

**Loopr** - El calendario m√°s avanzado y ligero para aplicaciones web modernas üöÄ
